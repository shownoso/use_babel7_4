### 使用优化插件是更好的选择

@babel/plugin-transform-runtime
 - 对 Babel 编译过程中产生的 helper 方法进行重新利用(聚合)，以达到减少打包体积的目的。
 - 避免全局补丁污染，对打包过的 bundler 提供“沙箱”式的补丁。

```bash
npm i -D @babel/plugin-transform-runtime

npm install -S @babel/runtime
npm install -S @babel/runtime-corejs2
npm install -S @babel/runtime-corejs3
```
修改babel.config.js
```js
const presets = [
	[
		"@babel/env",
		{
			useBuiltIns: 'usage',
			corejs: 3
		},
	],
];
const plugins = [
	[
    "@babel/plugin-transform-runtime", 
    {
      corejs: false // false对应@babel/runtime 2对应@babel/runtime-corejs2 3对应@babel/runtime-corejs2
    }
  ]
]
module.exports = {
	presets,
	plugins
};
```

src/index.js
```js
const a = () => {
  console.log(1)
}
Promise.resolve().finally();
```

#### plugin-transform-runtime 配置说明

1. @babel/runtime提供 helpers 函数，并会去安装regenerator-runtime包，只做语法转换(helpers 和 regenerator)， 没有新 api 的实现。
2. @babel/runtime-corejs2包含@babel/runtime的全部并额外安装core-js@2
3. @babel/runtime-corejs3包含@babel/runtime的全部并额外安装core-js-pure@3相比之下@babel/runtime-corejs3支持更多，包括实例，api 等。
4. 三者均依赖于@babel/plugin-transform-runtime使用。


### 作为类库开发时的使用
上述方式将污染全局  
<!-- 开发类库/工具（生成不污染全局空间和内置对象原型的代码）
借助 @babel/runtime 中帮助函数（helper function）移除冗余工具函数 -->
修改babel.config.js
```js
const presets = [
	[
		"@babel/env",
		{
      // 注意此处不要按需引入了，因为@babel/runtime-corejs3已经在代码内部引入了helper来处理
			// useBuiltIns: 'usage',
			// corejs: 3
		},
	],
];

const plugins = [
	[
		"@babel/plugin-transform-runtime",
		{
			corejs: 3
		}
	]
]


module.exports = {
	presets,
	plugins
};
```

